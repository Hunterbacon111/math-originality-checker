# 🎯 难度测试功能使用指南

## 📖 功能概述

难度测试功能通过让 AI 模型多次求解同一题目，统计正确率来智能评估题目难度。

### 核心特性

- **🧠 深度推理**: 使用 Doubao Seed 1.6 Thinking 模型，具备强大的数学推理能力
- **⚡ 并行计算**: 最多8个任务同时执行，大幅节省测试时间
- **📊 流式显示**: 每完成一次立即显示结果，无需等待全部完成
- **🛡️ 容错机制**: 单次求解失败不影响整体测试
- **📈 实时反馈**: 动态显示当前进度和正确率

## 🚀 使用步骤

### 1️⃣ 准备题目

支持两种输入方式：

#### 方式一：文字输入
直接在文本框中输入数学题目。

**示例**：
```
解方程：2x + 5 = 13
```

#### 方式二：图片上传
上传包含题目的图片（截图、照片、扫描件）。

**操作流程**：
1. 点击"选择图片文件"上传图片
2. 点击"🤖 AI识别题目"按钮
3. 等待 Mistral Pixtral 识别（约2-3秒）
4. 检查识别结果，如有错误可手动编辑

### 2️⃣ 输入标准答案

在"官方标准答案"框中输入正确答案。

**注意事项**：
- ✅ 答案要简洁明确
- ✅ 避免冗余文字
- ✅ 格式要统一

**示例**：
```
x = 4
```

或
```
答案：x = 4
```

### 3️⃣ 选择测试次数

使用滑块选择测试次数（3-10次）。

**建议**：
- 3-5次：快速初步评估
- 6-8次：推荐，平衡速度和准确性
- 9-10次：最精确，但耗时更长

💡 **注意**：由于采用并行计算，测试次数增加不会成倍增加等待时间！

### 4️⃣ 开始测试

点击"🚀 开始难度测试"按钮。

系统会：
1. 启动多个并行任务
2. 实时显示每次完成的结果
3. 动态更新进度条和统计数据
4. 显示每次求解的耗时

### 5️⃣ 查看结果

#### 实时进度表格
显示每次测试的：
- 测试序号
- 结果（✅正确 / ❌错误）
- 单次耗时

#### 统计分析
包括：
- **测试次数**: 总共执行的测试数
- **正确次数**: AI 答对的次数
- **正确率**: 正确次数 / 总次数
- **难度评估**: 
  - ✅ 80%+ → 简单
  - ⚠️ 50-80% → 中等
  - ❌ <50% → 困难

#### 详细测试记录
可展开查看每次测试的：
- 完整解答过程
- 解题思路
- 最终答案

## 🎯 难度评估标准

### ✅ 简单题目（正确率 ≥ 80%）
- AI 模型能稳定求解
- 适合作为基础练习题
- 大部分学生应该能够掌握

**示例**：
- 简单的一元一次方程
- 基础几何计算
- 简单的代数运算

### ⚠️ 中等难度（正确率 50-80%）
- AI 模型部分情况下能正确求解
- 适合作为常规练习题
- 需要一定的思考和计算能力

**示例**：
- 复杂的方程组
- 需要多步推理的几何题
- 综合应用题

### ❌ 困难题目（正确率 < 50%）
- AI 模型求解正确率低
- 适合作为挑战题或拔高题
- 需要较强的数学能力和解题技巧

**建议**：如果正确率过低，请检查：
1. 题目是否有歧义或表述不清
2. 题目是否存在错误
3. 标准答案是否正确

## ⚡ 并行计算原理

### 传统串行方式
```
测试1 → 测试2 → 测试3 → ... → 测试8
总耗时 = 8 × 单次耗时（例如：8 × 5秒 = 40秒）
```

### 并行计算方式
```
测试1 ┐
测试2 ├─→ 同时执行
测试3 ├─→ 同时执行
...   │
测试8 ┘
总耗时 ≈ 单次耗时（例如：约5-8秒）
```

### 优势
- ⚡ **速度快**: 8次测试只需1次的时间
- 🛡️ **更稳定**: 单次失败不影响其他任务
- 📊 **实时反馈**: 完成一个显示一个

### 限制
- 最多同时运行8个任务（避免API限流）
- 需要稳定的网络连接
- API Key 需要有足够的并发配额

## 💡 最佳实践

### 1. 题目准备
- ✅ 题目表述清晰完整
- ✅ 包含所有必要条件
- ✅ 避免歧义和模糊表述
- ✅ 图片上传时确保清晰可读

### 2. 答案格式
- ✅ 使用统一的答案格式
- ✅ 避免多余的解释文字
- ✅ 数值答案保留合理位数

**好的答案格式**：
```
x = 4
```

**不好的答案格式**：
```
通过计算，我们可以得出这道题的答案是x等于4
```

### 3. 测试次数选择
- 3-5次：用于快速验证
- 6-8次：日常使用推荐
- 9-10次：重要题目精确评估

### 4. 结果解读
- 观察正确率趋势
- 查看错误案例的共同点
- 结合题目特点综合判断

### 5. 故障排查
如遇到问题：
1. 检查网络连接
2. 确认 API Key 配置正确
3. 查看详细错误信息
4. 尝试减少测试次数

## 📊 使用场景

### 1. 试卷命题
- 评估题目难度分布
- 确保试卷难度梯度合理
- 避免过难或过易的题目

### 2. 作业布置
- 根据学生水平选择合适难度
- 设计分层作业
- 提供挑战题和基础题

### 3. 竞赛选题
- 筛选合适难度的竞赛题
- 评估题目区分度
- 预测学生得分情况

### 4. 题库建设
- 为题目标注难度等级
- 建立科学的难度分类体系
- 优化题目质量

## 🔧 技术细节

### 模型选择
**Doubao Seed 1.6 Thinking**
- 字节跳动开发的推理模型
- 擅长数学和逻辑推理
- 支持长文本和复杂计算

### 并发控制
- 使用 `ThreadPoolExecutor` 管理线程池
- `max_workers=min(test_count, 8)` 限制最大并发
- `as_completed()` 实现流式结果处理

### 答案比对
- 提取模型答案中的【答案：】标记
- 进行字符串标准化（小写、去空格）
- 支持包含匹配和精确匹配

## ❓ 常见问题

### Q1: 为什么有时正确率很低？
**可能原因**：
1. 题目本身确实很难
2. 题目表述有歧义
3. 标准答案格式特殊
4. 题目存在错误

**解决方案**：
- 检查题目和答案是否正确
- 查看详细的求解过程
- 调整标准答案格式

### Q2: 并行计算会增加API费用吗？
**答**：不会。API 费用只与请求次数有关，与是否并行无关。并行只是让多个请求同时进行，节省总时间。

### Q3: 最多能测试多少次？
**答**：当前支持3-10次。建议6-8次即可获得准确结果。

### Q4: 单次测试失败怎么办？
**答**：没关系！系统会继续其他测试，最终统计时会考虑所有成功的测试结果。

### Q5: 结果实时显示多久刷新一次？
**答**：每完成一次求解立即刷新显示，无固定间隔。

## 📞 技术支持

如遇到问题：
1. 查看实时日志信息
2. 检查 API 配置
3. 参考错误提示
4. 提交 GitHub Issue

---

🎯 **祝您使用愉快！**

